{"version":3,"file":"blur.js","sources":["../../src/dom/blur.ts"],"sourcesContent":["import getElement from './-get-element.ts';\nimport fireEvent from './fire-event.ts';\nimport settled from '../settled.ts';\nimport type { Target } from './-target.ts';\nimport { log } from './-logging.ts';\nimport isFocusable from './-is-focusable.ts';\nimport { runHooks, registerHook } from '../helper-hooks.ts';\nimport getDescription from './-get-description.ts';\n\nregisterHook('blur', 'start', (target: Target) => {\n  log('blur', target);\n});\n\n/**\n  @private\n  @param {Element} element the element to trigger events on\n  @param {Element} relatedTarget the element that is focused after blur\n  @return {Promise<Event | void>} resolves when settled\n*/\nexport function __blur__(\n  element: HTMLElement | Element | Document | SVGElement,\n  relatedTarget: HTMLElement | Element | Document | SVGElement | null = null,\n): Promise<Event | void> {\n  if (!isFocusable(element)) {\n    throw new Error(`${element} is not focusable`);\n  }\n\n  const browserIsNotFocused = document.hasFocus && !document.hasFocus();\n  const needsCustomEventOptions = relatedTarget !== null;\n\n  if (!needsCustomEventOptions) {\n    // makes `document.activeElement` be `body`.\n    // If the browser is focused, it also fires a blur event\n    element.blur();\n  }\n\n  // Chrome/Firefox does not trigger the `blur` event if the window\n  // does not have focus. If the document does not have focus then\n  // fire `blur` event via native event.\n  const options = { relatedTarget };\n  return browserIsNotFocused || needsCustomEventOptions\n    ? Promise.resolve()\n        .then(() => fireEvent(element, 'blur', { bubbles: false, ...options }))\n        .then(() => fireEvent(element, 'focusout', options))\n    : Promise.resolve();\n}\n\n/**\n  Unfocus the specified target.\n\n  Sends a number of events intending to simulate a \"real\" user unfocusing an\n  element.\n\n  The following events are triggered (in order):\n\n  - `blur`\n  - `focusout`\n\n  The exact listing of events that are triggered may change over time as needed\n  to continue to emulate how actual browsers handle unfocusing a given element.\n\n  @public\n  @param {string|Element|IDOMElementDescriptor} [target=document.activeElement] the element, selector, or descriptor to unfocus\n  @return {Promise<void>} resolves when settled\n\n  @example\n  <caption>\n    Emulating blurring an input using `blur`\n  </caption>\n\n  blur('input');\n*/\nexport default function blur(\n  target: Target = document.activeElement!,\n): Promise<void> {\n  return Promise.resolve()\n    .then(() => runHooks('blur', 'start', target))\n    .then(() => {\n      const element = getElement(target);\n      if (!element) {\n        const description = getDescription(target);\n        throw new Error(\n          `Element not found when calling \\`blur('${description}')\\`.`,\n        );\n      }\n\n      return __blur__(element).then(() => settled());\n    })\n    .then(() => runHooks('blur', 'end', target));\n}\n"],"names":["registerHook","target","log","__blur__","element","relatedTarget","isFocusable","Error","browserIsNotFocused","document","hasFocus","needsCustomEventOptions","blur","options","Promise","resolve","then","fireEvent","bubbles","activeElement","runHooks","getElement","description","getDescription","settled"],"mappings":";;;;;;;;AASAA,YAAY,CAAC,MAAM,EAAE,OAAO,EAAGC,MAAc,IAAK;AAChDC,EAAAA,GAAG,CAAC,MAAM,EAAED,MAAM,CAAC,CAAA;AACrB,CAAC,CAAC,CAAA;;AAEF;AACA;AACA;AACA;AACA;AACA;AACO,SAASE,QAAQA,CACtBC,OAAsD,EACtDC,aAAmE,GAAG,IAAI,EACnD;AACvB,EAAA,IAAI,CAACC,WAAW,CAACF,OAAO,CAAC,EAAE;AACzB,IAAA,MAAM,IAAIG,KAAK,CAAC,CAAGH,EAAAA,OAAO,mBAAmB,CAAC,CAAA;AAChD,GAAA;EAEA,MAAMI,mBAAmB,GAAGC,QAAQ,CAACC,QAAQ,IAAI,CAACD,QAAQ,CAACC,QAAQ,EAAE,CAAA;AACrE,EAAA,MAAMC,uBAAuB,GAAGN,aAAa,KAAK,IAAI,CAAA;EAEtD,IAAI,CAACM,uBAAuB,EAAE;AAC5B;AACA;IACAP,OAAO,CAACQ,IAAI,EAAE,CAAA;AAChB,GAAA;;AAEA;AACA;AACA;AACA,EAAA,MAAMC,OAAO,GAAG;AAAER,IAAAA,aAAAA;GAAe,CAAA;AACjC,EAAA,OAAOG,mBAAmB,IAAIG,uBAAuB,GACjDG,OAAO,CAACC,OAAO,EAAE,CACdC,IAAI,CAAC,MAAMC,SAAS,CAACb,OAAO,EAAE,MAAM,EAAE;AAAEc,IAAAA,OAAO,EAAE,KAAK;IAAE,GAAGL,OAAAA;GAAS,CAAC,CAAC,CACtEG,IAAI,CAAC,MAAMC,SAAS,CAACb,OAAO,EAAE,UAAU,EAAES,OAAO,CAAC,CAAC,GACtDC,OAAO,CAACC,OAAO,EAAE,CAAA;AACvB,CAAA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACe,SAASH,IAAIA,CAC1BX,MAAc,GAAGQ,QAAQ,CAACU,aAAc,EACzB;EACf,OAAOL,OAAO,CAACC,OAAO,EAAE,CACrBC,IAAI,CAAC,MAAMI,QAAQ,CAAC,MAAM,EAAE,OAAO,EAAEnB,MAAM,CAAC,CAAC,CAC7Ce,IAAI,CAAC,MAAM;AACV,IAAA,MAAMZ,OAAO,GAAGiB,UAAU,CAACpB,MAAM,CAAC,CAAA;IAClC,IAAI,CAACG,OAAO,EAAE;AACZ,MAAA,MAAMkB,WAAW,GAAGC,cAAc,CAACtB,MAAM,CAAC,CAAA;AAC1C,MAAA,MAAM,IAAIM,KAAK,CACb,CAA0Ce,uCAAAA,EAAAA,WAAW,OACvD,CAAC,CAAA;AACH,KAAA;IAEA,OAAOnB,QAAQ,CAACC,OAAO,CAAC,CAACY,IAAI,CAAC,MAAMQ,OAAO,EAAE,CAAC,CAAA;AAChD,GAAC,CAAC,CACDR,IAAI,CAAC,MAAMI,QAAQ,CAAC,MAAM,EAAE,KAAK,EAAEnB,MAAM,CAAC,CAAC,CAAA;AAChD;;;;"}