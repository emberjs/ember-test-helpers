{"version":3,"file":"fill-in.js","sources":["../../src/dom/fill-in.ts"],"sourcesContent":["import getElement from './-get-element.ts';\nimport isFormControl, { type FormControl } from './-is-form-control.ts';\nimport guardForMaxlength from './-guard-for-maxlength.ts';\nimport { __focus__ } from './focus.ts';\nimport settled from '../settled.ts';\nimport fireEvent from './fire-event.ts';\nimport { isContentEditable, type Target } from './-target.ts';\nimport { log } from './-logging.ts';\nimport { runHooks, registerHook } from '../helper-hooks.ts';\nimport getDescription from './-get-description.ts';\n\nregisterHook('fillIn', 'start', (target: Target, text: string) => {\n  log('fillIn', target, text);\n});\n\n/**\n  Fill the provided text into the `value` property (or set `.innerHTML` when\n  the target is a content editable element) then trigger `change` and `input`\n  events on the specified target.\n\n  @public\n  @param {string|Element|IDOMElementDescriptor} target the element, selector, or descriptor to enter text into\n  @param {string} text the text to fill into the target element\n  @return {Promise<void>} resolves when the application is settled\n\n  @example\n  <caption>\n    Emulating filling an input with text using `fillIn`\n  </caption>\n\n  fillIn('input', 'hello world');\n*/\nexport default function fillIn(target: Target, text: string): Promise<void> {\n  return Promise.resolve()\n    .then(() => runHooks('fillIn', 'start', target, text))\n    .then(() => {\n      if (!target) {\n        throw new Error(\n          'Must pass an element, selector, or descriptor to `fillIn`.',\n        );\n      }\n\n      const element = getElement(target) as Element | HTMLElement;\n      if (!element) {\n        const description = getDescription(target);\n        throw new Error(\n          `Element not found when calling \\`fillIn('${description}')\\`.`,\n        );\n      }\n\n      if (typeof text === 'undefined' || text === null) {\n        throw new Error('Must provide `text` when calling `fillIn`.');\n      }\n\n      if (isFormControl(element)) {\n        if (element.disabled) {\n          throw new Error(\n            `Can not \\`fillIn\\` disabled '${getDescription(target)}'.`,\n          );\n        }\n\n        if ('readOnly' in element && element.readOnly) {\n          throw new Error(\n            `Can not \\`fillIn\\` readonly '${getDescription(target)}'.`,\n          );\n        }\n\n        guardForMaxlength(element, text, 'fillIn');\n\n        return __focus__(element).then(() => {\n          (element as FormControl).value = text;\n          return element;\n        });\n      } else if (isContentEditable(element)) {\n        return __focus__(element).then(() => {\n          element.innerHTML = text;\n          return element as Element;\n        });\n      } else {\n        throw new Error(\n          '`fillIn` is only usable on form controls or contenteditable elements.',\n        );\n      }\n    })\n    .then((element) =>\n      fireEvent(element, 'input')\n        .then(() => fireEvent(element, 'change'))\n        .then(settled),\n    )\n    .then(() => runHooks('fillIn', 'end', target, text));\n}\n"],"names":["registerHook","target","text","log","fillIn","Promise","resolve","then","runHooks","Error","element","getElement","description","getDescription","isFormControl","disabled","readOnly","guardForMaxlength","__focus__","value","isContentEditable","innerHTML","fireEvent","settled"],"mappings":";;;;;;;;;;;AAWAA,YAAY,CAAC,QAAQ,EAAE,OAAO,EAAE,CAACC,MAAc,EAAEC,IAAY,KAAK;AAChEC,EAAAA,GAAG,CAAC,QAAQ,EAAEF,MAAM,EAAEC,IAAI,CAAC,CAAA;AAC7B,CAAC,CAAC,CAAA;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACe,SAASE,MAAMA,CAACH,MAAc,EAAEC,IAAY,EAAiB;EAC1E,OAAOG,OAAO,CAACC,OAAO,EAAE,CACrBC,IAAI,CAAC,MAAMC,QAAQ,CAAC,QAAQ,EAAE,OAAO,EAAEP,MAAM,EAAEC,IAAI,CAAC,CAAC,CACrDK,IAAI,CAAC,MAAM;IACV,IAAI,CAACN,MAAM,EAAE;AACX,MAAA,MAAM,IAAIQ,KAAK,CACb,4DACF,CAAC,CAAA;AACH,KAAA;AAEA,IAAA,MAAMC,OAAO,GAAGC,UAAU,CAACV,MAAM,CAA0B,CAAA;IAC3D,IAAI,CAACS,OAAO,EAAE;AACZ,MAAA,MAAME,WAAW,GAAGC,cAAc,CAACZ,MAAM,CAAC,CAAA;AAC1C,MAAA,MAAM,IAAIQ,KAAK,CACb,CAA4CG,yCAAAA,EAAAA,WAAW,OACzD,CAAC,CAAA;AACH,KAAA;IAEA,IAAI,OAAOV,IAAI,KAAK,WAAW,IAAIA,IAAI,KAAK,IAAI,EAAE;AAChD,MAAA,MAAM,IAAIO,KAAK,CAAC,4CAA4C,CAAC,CAAA;AAC/D,KAAA;AAEA,IAAA,IAAIK,aAAa,CAACJ,OAAO,CAAC,EAAE;MAC1B,IAAIA,OAAO,CAACK,QAAQ,EAAE;QACpB,MAAM,IAAIN,KAAK,CACb,CAAA,6BAAA,EAAgCI,cAAc,CAACZ,MAAM,CAAC,CAAA,EAAA,CACxD,CAAC,CAAA;AACH,OAAA;AAEA,MAAA,IAAI,UAAU,IAAIS,OAAO,IAAIA,OAAO,CAACM,QAAQ,EAAE;QAC7C,MAAM,IAAIP,KAAK,CACb,CAAA,6BAAA,EAAgCI,cAAc,CAACZ,MAAM,CAAC,CAAA,EAAA,CACxD,CAAC,CAAA;AACH,OAAA;AAEAgB,MAAAA,iBAAiB,CAACP,OAAO,EAAER,IAAI,EAAE,QAAQ,CAAC,CAAA;AAE1C,MAAA,OAAOgB,SAAS,CAACR,OAAO,CAAC,CAACH,IAAI,CAAC,MAAM;QAClCG,OAAO,CAAiBS,KAAK,GAAGjB,IAAI,CAAA;AACrC,QAAA,OAAOQ,OAAO,CAAA;AAChB,OAAC,CAAC,CAAA;AACJ,KAAC,MAAM,IAAIU,iBAAiB,CAACV,OAAO,CAAC,EAAE;AACrC,MAAA,OAAOQ,SAAS,CAACR,OAAO,CAAC,CAACH,IAAI,CAAC,MAAM;QACnCG,OAAO,CAACW,SAAS,GAAGnB,IAAI,CAAA;AACxB,QAAA,OAAOQ,OAAO,CAAA;AAChB,OAAC,CAAC,CAAA;AACJ,KAAC,MAAM;AACL,MAAA,MAAM,IAAID,KAAK,CACb,uEACF,CAAC,CAAA;AACH,KAAA;AACF,GAAC,CAAC,CACDF,IAAI,CAAEG,OAAO,IACZY,SAAS,CAACZ,OAAO,EAAE,OAAO,CAAC,CACxBH,IAAI,CAAC,MAAMe,SAAS,CAACZ,OAAO,EAAE,QAAQ,CAAC,CAAC,CACxCH,IAAI,CAACgB,OAAO,CACjB,CAAC,CACAhB,IAAI,CAAC,MAAMC,QAAQ,CAAC,QAAQ,EAAE,KAAK,EAAEP,MAAM,EAAEC,IAAI,CAAC,CAAC,CAAA;AACxD;;;;"}