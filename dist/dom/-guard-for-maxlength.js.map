{"version":3,"file":"-guard-for-maxlength.js","sources":["../../src/dom/-guard-for-maxlength.ts"],"sourcesContent":["import type { FormControl } from './-is-form-control';\n\n// ref: https://html.spec.whatwg.org/multipage/input.html#concept-input-apply\nconst constrainedInputTypes = [\n  'text',\n  'search',\n  'url',\n  'tel',\n  'email',\n  'password',\n];\n\n/**\n  @private\n  @param {Element} element - the element to check\n  @returns {boolean} `true` when the element should constrain input by the maxlength attribute, `false` otherwise\n*/\nfunction isMaxLengthConstrained(\n  element: Element,\n): element is HTMLInputElement | HTMLTextAreaElement {\n  return (\n    !!Number(element.getAttribute('maxlength')) &&\n    (element instanceof HTMLTextAreaElement ||\n      (element instanceof HTMLInputElement &&\n        constrainedInputTypes.indexOf(element.type) > -1))\n  );\n}\n\n/**\n * @private\n * @param {Element} element - the element to check\n * @param {string} text - the text being added to element\n * @param {string} testHelper - the test helper context the guard is called from (for Error message)\n * @throws if `element` has `maxlength` & `value` exceeds `maxlength`\n */\nexport default function guardForMaxlength(\n  element: FormControl,\n  text: string,\n  testHelper: string,\n): void {\n  const maxlength = element.getAttribute('maxlength');\n  if (\n    isMaxLengthConstrained(element) &&\n    maxlength &&\n    text &&\n    text.length > Number(maxlength)\n  ) {\n    throw new Error(\n      `Can not \\`${testHelper}\\` with text: '${text}' that exceeds maxlength: '${maxlength}'.`,\n    );\n  }\n}\n"],"names":["constrainedInputTypes","isMaxLengthConstrained","element","Number","getAttribute","HTMLTextAreaElement","HTMLInputElement","indexOf","type","guardForMaxlength","text","testHelper","maxlength","length","Error"],"mappings":"AAEA;AACA,MAAMA,qBAAqB,GAAG,CAC5B,MAAM,EACN,QAAQ,EACR,KAAK,EACL,KAAK,EACL,OAAO,EACP,UAAU,CACX,CAAA;;AAED;AACA;AACA;AACA;AACA;AACA,SAASC,sBAAsBA,CAC7BC,OAAgB,EACmC;AACnD,EAAA,OACE,CAAC,CAACC,MAAM,CAACD,OAAO,CAACE,YAAY,CAAC,WAAW,CAAC,CAAC,KAC1CF,OAAO,YAAYG,mBAAmB,IACpCH,OAAO,YAAYI,gBAAgB,IAClCN,qBAAqB,CAACO,OAAO,CAACL,OAAO,CAACM,IAAI,CAAC,GAAG,CAAC,CAAE,CAAC,CAAA;AAE1D,CAAA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACe,SAASC,iBAAiBA,CACvCP,OAAoB,EACpBQ,IAAY,EACZC,UAAkB,EACZ;AACN,EAAA,MAAMC,SAAS,GAAGV,OAAO,CAACE,YAAY,CAAC,WAAW,CAAC,CAAA;AACnD,EAAA,IACEH,sBAAsB,CAACC,OAAO,CAAC,IAC/BU,SAAS,IACTF,IAAI,IACJA,IAAI,CAACG,MAAM,GAAGV,MAAM,CAACS,SAAS,CAAC,EAC/B;IACA,MAAM,IAAIE,KAAK,CACb,CAAaH,UAAAA,EAAAA,UAAU,kBAAkBD,IAAI,CAAA,2BAAA,EAA8BE,SAAS,CAAA,EAAA,CACtF,CAAC,CAAA;AACH,GAAA;AACF;;;;"}