{"version":3,"file":"trigger-event.js","sources":["../../src/dom/trigger-event.ts"],"sourcesContent":["import { getWindowOrElement } from './-get-window-or-element.ts';\nimport fireEvent from './fire-event.ts';\nimport settled from '../settled.ts';\nimport type { Target } from './-target.ts';\nimport { log } from './-logging.ts';\nimport isFormControl from './-is-form-control.ts';\nimport { runHooks, registerHook } from '../helper-hooks.ts';\nimport getDescription from './-get-description.ts';\n\nregisterHook('triggerEvent', 'start', (target: Target, eventType: string) => {\n  log('triggerEvent', target, eventType);\n});\n\n/**\n * Triggers an event on the specified target.\n *\n * @public\n * @param {string|Element|IDOMElementDescriptor} target the element, selector, or descriptor to trigger the event on\n * @param {string} eventType the type of event to trigger\n * @param {Object} options additional properties to be set on the event\n * @param {boolean} force if true, will bypass availability checks (false by default)\n * @return {Promise<void>} resolves when the application is settled\n *\n * @example\n * <caption>\n * Using `triggerEvent` to upload a file\n *\n * When using `triggerEvent` to upload a file the `eventType` must be `change` and you must pass the\n * `options` param as an object with a key `files` containing an array of\n * [Blob](https://developer.mozilla.org/en-US/docs/Web/API/Blob).\n * </caption>\n *\n * triggerEvent(\n *   'input.fileUpload',\n *   'change',\n *   { files: [new Blob(['Ember Rules!'])] }\n * );\n *\n *\n * @example\n * <caption>\n * Using `triggerEvent` to upload a dropped file\n *\n * When using `triggerEvent` to handle a dropped (via drag-and-drop) file, the `eventType` must be `drop`. Assuming your `drop` event handler uses the [DataTransfer API](https://developer.mozilla.org/en-US/docs/Web/API/DataTransfer),\n * you must pass the `options` param as an object with a key of `dataTransfer`. The `options.dataTransfer`     object should have a `files` key, containing an array of [File](https://developer.mozilla.org/en-US/docs/Web/API/File).\n * </caption>\n *\n * triggerEvent(\n *   '[data-test-drop-zone]',\n *   'drop',\n *   {\n *     dataTransfer: {\n *       files: [new File(['Ember Rules!'], 'ember-rules.txt')]\n *     }\n *   }\n * )\n */\nexport default function triggerEvent(\n  target: Target,\n  eventType: string,\n  options?: Record<string, unknown>,\n  force: boolean = false,\n): Promise<void> {\n  return Promise.resolve()\n    .then(() => {\n      return runHooks('triggerEvent', 'start', target, eventType, options);\n    })\n    .then(() => {\n      if (!target) {\n        throw new Error(\n          'Must pass an element, selector, or descriptor to `triggerEvent`.',\n        );\n      }\n\n      if (!eventType) {\n        throw new Error(`Must provide an \\`eventType\\` to \\`triggerEvent\\``);\n      }\n\n      const element = getWindowOrElement(target);\n      if (!element) {\n        const description = getDescription(target);\n        throw new Error(\n          `Element not found when calling \\`triggerEvent('${description}', ...)\\`.`,\n        );\n      }\n\n      if (!force && isFormControl(element) && element.disabled) {\n        throw new Error(`Can not \\`triggerEvent\\` on disabled ${element}`);\n      }\n\n      return fireEvent(element, eventType, options).then(settled);\n    })\n    .then(() => {\n      return runHooks('triggerEvent', 'end', target, eventType, options);\n    });\n}\n"],"names":["registerHook","target","eventType","log","triggerEvent","options","force","Promise","resolve","then","runHooks","Error","element","getWindowOrElement","description","getDescription","isFormControl","disabled","fireEvent","settled"],"mappings":";;;;;;;;AASAA,YAAY,CAAC,cAAc,EAAE,OAAO,EAAE,CAACC,MAAc,EAAEC,SAAiB,KAAK;AAC3EC,EAAAA,GAAG,CAAC,cAAc,EAAEF,MAAM,EAAEC,SAAS,CAAC,CAAA;AACxC,CAAC,CAAC,CAAA;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACe,SAASE,YAAYA,CAClCH,MAAc,EACdC,SAAiB,EACjBG,OAAiC,EACjCC,KAAc,GAAG,KAAK,EACP;EACf,OAAOC,OAAO,CAACC,OAAO,EAAE,CACrBC,IAAI,CAAC,MAAM;IACV,OAAOC,QAAQ,CAAC,cAAc,EAAE,OAAO,EAAET,MAAM,EAAEC,SAAS,EAAEG,OAAO,CAAC,CAAA;AACtE,GAAC,CAAC,CACDI,IAAI,CAAC,MAAM;IACV,IAAI,CAACR,MAAM,EAAE;AACX,MAAA,MAAM,IAAIU,KAAK,CACb,kEACF,CAAC,CAAA;AACH,KAAA;IAEA,IAAI,CAACT,SAAS,EAAE;AACd,MAAA,MAAM,IAAIS,KAAK,CAAC,CAAA,iDAAA,CAAmD,CAAC,CAAA;AACtE,KAAA;AAEA,IAAA,MAAMC,OAAO,GAAGC,kBAAkB,CAACZ,MAAM,CAAC,CAAA;IAC1C,IAAI,CAACW,OAAO,EAAE;AACZ,MAAA,MAAME,WAAW,GAAGC,cAAc,CAACd,MAAM,CAAC,CAAA;AAC1C,MAAA,MAAM,IAAIU,KAAK,CACb,CAAkDG,+CAAAA,EAAAA,WAAW,YAC/D,CAAC,CAAA;AACH,KAAA;IAEA,IAAI,CAACR,KAAK,IAAIU,aAAa,CAACJ,OAAO,CAAC,IAAIA,OAAO,CAACK,QAAQ,EAAE;AACxD,MAAA,MAAM,IAAIN,KAAK,CAAC,CAAwCC,qCAAAA,EAAAA,OAAO,EAAE,CAAC,CAAA;AACpE,KAAA;AAEA,IAAA,OAAOM,SAAS,CAACN,OAAO,EAAEV,SAAS,EAAEG,OAAO,CAAC,CAACI,IAAI,CAACU,OAAO,CAAC,CAAA;AAC7D,GAAC,CAAC,CACDV,IAAI,CAAC,MAAM;IACV,OAAOC,QAAQ,CAAC,cAAc,EAAE,KAAK,EAAET,MAAM,EAAEC,SAAS,EAAEG,OAAO,CAAC,CAAA;AACpE,GAAC,CAAC,CAAA;AACN;;;;"}